# é¦–é¡µç”¨æˆ·æ¨èæ¥å£æ–‡æ¡£

> æ›´æ–°æ—¥æœŸ: 2025-11-28
> çŠ¶æ€: å¾…åç«¯å®ç°

## ä¸€ã€æ¥å£æ¦‚è¿°

é¦–é¡µä¸»åˆ—è¡¨åŒºåŸŸéœ€è¦å±•ç¤º**ç”¨æˆ·æ¨èå¡ç‰‡**ï¼Œè€ŒéåŠ¨æ€å†…å®¹æµã€‚

### å½“å‰é—®é¢˜
- å‰ç«¯é”™è¯¯åœ°ä½¿ç”¨äº† Feed å†…å®¹æµæ¥å£ (`/xypai-content/api/v1/content/feed/{tabType}`)
- Feed æ¥å£è¿”å›çš„æ˜¯ç”¨æˆ·å‘å¸ƒçš„åŠ¨æ€å†…å®¹ï¼Œé€‚ç”¨äº"å‘ç°"é¡µé¢
- é¦–é¡µéœ€è¦çš„æ˜¯ç”¨æˆ·æ¨èåˆ—è¡¨ï¼Œå±•ç¤ºå¯é¢„çº¦/å¯åŒ¹é…çš„ç”¨æˆ·ä¿¡æ¯

### æ­£ç¡®çš„æ¥å£
é¦–é¡µåº”è¯¥ä½¿ç”¨ BFF ç”¨æˆ·æ¨èæ¥å£ï¼š
- **æ¥å£è·¯å¾„**: `GET /xypai-app-bff/api/home/users`
- **åŠŸèƒ½**: è·å–é¦–é¡µç”¨æˆ·æ¨èåˆ—è¡¨ï¼ˆé™„è¿‘/æ¨è/æœ€æ–°ï¼‰

---

## äºŒã€æ¥å£å®šä¹‰

### 1. è·å–ç”¨æˆ·æ¨èåˆ—è¡¨

**è¯·æ±‚**
```
GET /xypai-app-bff/api/home/users?tab={tabType}&pageNum=1&pageSize=10&cityCode=440300
```

**æŸ¥è¯¢å‚æ•°**

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| tab | string | âœ… | ç­›é€‰ç±»å‹: `nearby`(é™„è¿‘) / `recommend`(æ¨è) / `latest`(æœ€æ–°) |
| pageNum | number | âŒ | é¡µç ï¼Œé»˜è®¤1 |
| pageSize | number | âŒ | æ¯é¡µæ•°é‡ï¼Œé»˜è®¤10 |
| cityCode | string | âŒ | åŸå¸‚ä»£ç ï¼Œå¦‚440300(æ·±åœ³) |
| region | string | âŒ | åŒºåŸŸç­›é€‰ï¼Œå¦‚"å—å±±åŒº" |
| latitude | number | âŒ | ç”¨æˆ·çº¬åº¦ï¼ˆé™„è¿‘Tabå¿…å¡«ï¼‰ |
| longitude | number | âŒ | ç”¨æˆ·ç»åº¦ï¼ˆé™„è¿‘Tabå¿…å¡«ï¼‰ |

**å“åº”æ•°æ®ç»“æ„**

```typescript
interface HomeUsersResponse {
  list: UserCard[];       // ç”¨æˆ·åˆ—è¡¨
  total: number;          // æ€»æ•°
  hasMore: boolean;       // æ˜¯å¦æœ‰æ›´å¤š
  pageNum: number;        // å½“å‰é¡µç 
  pageSize: number;       // æ¯é¡µæ•°é‡
}

interface UserCard {
  // === åŸºæœ¬ä¿¡æ¯ ===
  userId: string;                    // ç”¨æˆ·ID
  nickname: string;                  // ç”¨æˆ·æ˜µç§°
  avatar: string;                    // å¤´åƒURL
  age: number;                       // å¹´é¾„
  gender: 'male' | 'female';         // æ€§åˆ«
  bio: string;                       // ä¸ªäººç®€ä»‹ï¼ˆå¦‚ï¼šè¿™ä¸ªå®¶ä¼™å¾ˆæ‡’æƒ°ï¼Œæ²¡æœ‰å¡«å†™ç®€ä»‹ï¼‰

  // === çŠ¶æ€ä¿¡æ¯ ===
  status: 'online' | 'available' | 'offline';  // çŠ¶æ€ï¼šåœ¨çº¿/å¯é¢„çº¦/ç¦»çº¿
  lastActive?: number;               // æœ€åæ´»è·ƒæ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰

  // === ä½ç½®ä¿¡æ¯ ===
  distance: number;                  // è·ç¦»ï¼ˆå…¬é‡Œï¼Œå¦‚ 4.6ï¼‰
  region?: string;                   // åŒºåŸŸï¼ˆå¦‚ï¼šå—å±±åŒºï¼‰

  // === æœåŠ¡ä¿¡æ¯ ===
  services: string[];                // æœåŠ¡æ ‡ç­¾åˆ—è¡¨ï¼ˆå¦‚ï¼š["æ¨¡ç‰¹", "é™ªç©", "èŠå¤©"]ï¼‰
  primaryService?: string;           // ä¸»è¦æœåŠ¡ç±»å‹
  price?: string;                    // ä»·æ ¼ä¿¡æ¯ï¼ˆå¦‚ï¼šÂ¥100/å°æ—¶ï¼‰

  // === è®¤è¯ä¿¡æ¯ ===
  isRealVerified?: boolean;          // æ˜¯å¦å®åè®¤è¯
  isGodVerified?: boolean;           // æ˜¯å¦å¤§ç¥è®¤è¯
  isVip?: boolean;                   // æ˜¯å¦VIP

  // === ç»Ÿè®¡ä¿¡æ¯ ===
  rating?: number;                   // è¯„åˆ†ï¼ˆå¦‚ 4.8ï¼‰
  reviewCount?: number;              // è¯„ä»·æ•°é‡
  orderCount?: number;               // æ¥å•æ•°é‡

  // === ä½œå“å±•ç¤º ===
  photos: string[];                  // ä½œå“ç¼©ç•¥å›¾åˆ—è¡¨ï¼ˆæœ€å¤š3å¼ ï¼Œç”¨äºå³ä¾§å±•ç¤ºï¼‰
}
```

**å“åº”ç¤ºä¾‹**

```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "list": [
      {
        "userId": "user_123456",
        "nickname": "ç”¨æˆ·åç§°123",
        "avatar": "https://cdn.example.com/avatars/123.jpg",
        "age": 18,
        "gender": "female",
        "bio": "è¿™ä¸ªå®¶ä¼™å¾ˆæ‡’æƒ°ï¼Œæ²¡æœ‰å¡«å†™ç®€ä»‹",
        "status": "online",
        "lastActive": 1732780800000,
        "distance": 4.6,
        "region": "å—å±±åŒº",
        "services": ["æ¨¡ç‰¹", "é™ªç©"],
        "primaryService": "æ¨¡ç‰¹",
        "price": "Â¥100/å°æ—¶",
        "isRealVerified": true,
        "isGodVerified": false,
        "isVip": true,
        "rating": 4.8,
        "reviewCount": 128,
        "orderCount": 256,
        "photos": [
          "https://cdn.example.com/photos/1.jpg",
          "https://cdn.example.com/photos/2.jpg",
          "https://cdn.example.com/photos/3.jpg"
        ]
      }
    ],
    "total": 100,
    "hasMore": true,
    "pageNum": 1,
    "pageSize": 10
  }
}
```

---

## ä¸‰ã€å‰ç«¯UIå±•ç¤ºå¯¹åº”

æ ¹æ®è®¾è®¡æ–‡æ¡£ï¼Œç”¨æˆ·å¡ç‰‡å±•ç¤ºç»“æ„ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”  ç”¨æˆ·åç§°123  â™€18        ğŸ“ 4.6km                      â”‚
â”‚ â”‚ å¤´åƒ  â”‚  è¿™ä¸ªå®¶ä¼™å¾ˆæ‡’æƒ°ï¼Œæ²¡æœ‰å¡«å†™ç®€ä»‹                           â”‚
â”‚ â”‚ 64px â”‚  â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”            â”‚
â”‚ â”‚      â”‚  â”‚ æ¨¡ç‰¹  â”‚ â”‚â— åœ¨çº¿ â”‚      â”‚ ğŸ“· â”‚â”‚ ğŸ“· â”‚â”‚ ğŸ“· â”‚            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å­—æ®µæ˜ å°„**
| UIå…ƒç´  | æ•°æ®å­—æ®µ | è¯´æ˜ |
|--------|----------|------|
| ç”¨æˆ·å¤´åƒ | avatar | åœ†å½¢64x64px |
| ç”¨æˆ·æ˜µç§° | nickname | 16spé»‘è‰²ç²—ä½“ |
| æ€§åˆ«å¹´é¾„ | gender + age | â™€18 æˆ– â™‚25ï¼Œç²‰è‰²æ˜¾ç¤º |
| è·ç¦» | distance | ğŸ“ 4.6km |
| ä¸ªäººç®€ä»‹ | bio | 14spç°è‰²ï¼Œæœ€å¤š2è¡Œ |
| æœåŠ¡æ ‡ç­¾ | services[0] | ç´«è‰²èƒŒæ™¯æ ‡ç­¾ |
| åœ¨çº¿çŠ¶æ€ | status | ç»¿è‰²(online)/æ©™è‰²(available)/ç°è‰²(offline) |
| ä½œå“ç¼©ç•¥å›¾ | photos | å³ä¾§3å¼ 32x32æ–¹å½¢å›¾ |

---

## å››ã€ç­›é€‰Tabè¯´æ˜

### Tabç±»å‹

| Tab | å€¼ | æ’åºé€»è¾‘ | è¯´æ˜ |
|-----|------|----------|------|
| é™„è¿‘ | `nearby` | è·ç¦»ä»è¿‘åˆ°è¿œ | éœ€è¦ç”¨æˆ·GPSåæ ‡ |
| æ¨è | `recommend` | æ™ºèƒ½æ¨èç®—æ³• | ä¸ªæ€§åŒ–åŒ¹é… |
| æœ€æ–° | `latest` | æ³¨å†Œæ—¶é—´/æ´»è·ƒæ—¶é—´ | æ–°ç”¨æˆ·ä¼˜å…ˆ |

### é™„è¿‘Tabç®—æ³•
```
1. è·å–ç”¨æˆ·å½“å‰GPSåæ ‡
2. è®¡ç®—æ‰€æœ‰ç”¨æˆ·ä¸å½“å‰ç”¨æˆ·çš„è·ç¦»
3. æŒ‰è·ç¦»å‡åºæ’åˆ—
4. å¯é€‰ï¼šé™åˆ¶æœ€å¤§è·ç¦»èŒƒå›´ï¼ˆå¦‚10kmå†…ï¼‰
```

### æ¨èTabç®—æ³•
```
1. åŸºäºç”¨æˆ·ç”»åƒåŒ¹é…ï¼ˆå…´è¶£ã€å¹´é¾„ã€æ€§åˆ«åå¥½ï¼‰
2. åŸºäºå†å²è¡Œä¸ºï¼ˆæµè§ˆã€ç‚¹å‡»ã€ä¸‹å•ï¼‰
3. åŸºäºååŒè¿‡æ»¤ï¼ˆç›¸ä¼¼ç”¨æˆ·å–œæ¬¢çš„ï¼‰
4. ç»¼åˆè¯„åˆ†æ’åº
```

### æœ€æ–°Tabç®—æ³•
```
1. æŒ‰ç”¨æˆ·æ³¨å†Œæ—¶é—´æ’åºï¼ˆæ–°ç”¨æˆ·ä¼˜å…ˆï¼‰
2. æˆ–æŒ‰æœ€åæ´»è·ƒæ—¶é—´æ’åº
3. æ–°ç”¨æˆ·å¯åŠ "NEW"æ ‡è¯†
```

---

## äº”ã€ä¸Feedæ¥å£çš„åŒºåˆ«

| å¯¹æ¯”é¡¹ | é¦–é¡µç”¨æˆ·æ¨è | FeedåŠ¨æ€æµ |
|--------|-------------|-----------|
| æ¥å£è·¯å¾„ | `/api/home/users` | `/api/content/feed/{tabType}` |
| æ•°æ®ç±»å‹ | ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ | åŠ¨æ€å†…å®¹ï¼ˆå›¾æ–‡/è§†é¢‘ï¼‰ |
| ä½¿ç”¨åœºæ™¯ | é¦–é¡µä¸»åˆ—è¡¨ | å‘ç°é¡µé¢ |
| æ ¸å¿ƒç›®çš„ | ç”¨æˆ·åŒ¹é…/é¢„çº¦ | å†…å®¹æµè§ˆ/äº’åŠ¨ |
| äº¤äº’åŠ¨ä½œ | æŸ¥çœ‹ä¸»é¡µâ†’ç§ä¿¡â†’ä¸‹å• | ç‚¹èµ/è¯„è®º/åˆ†äº« |

---

## å…­ã€å‰ç«¯éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶

1. **useHomeState.ts** - åˆ‡æ¢ä½¿ç”¨ç”¨æˆ·æ¨èAPI
2. **useHomeData.ts** - æ·»åŠ  `loadHomeUsers()` æ–¹æ³•
3. **MainPage.tsx** - ä¼ é€’æ­£ç¡®çš„æ•°æ®åˆ° UserListArea
4. **UserListArea** - ä½¿ç”¨ UserCardComponent è€Œé FeedCardComponent

---

## ä¸ƒã€å¾…ç¡®è®¤äº‹é¡¹

1. æ˜¯å¦éœ€è¦æ–°å»ºæ¥å£ `/api/home/users`ï¼Œè¿˜æ˜¯å¤ç”¨ç°æœ‰ `/api/home/feed`ï¼Ÿ
2. åŒºåŸŸç­›é€‰çš„åŒºåŸŸåˆ—è¡¨ä»å“ªä¸ªæ¥å£è·å–ï¼Ÿ
3. è·ç¦»è®¡ç®—æ˜¯åç«¯è®¡ç®—è¿˜æ˜¯å‰ç«¯è®¡ç®—ï¼Ÿ
4. æ¨èç®—æ³•çš„å…·ä½“æƒé‡å’Œè§„åˆ™ï¼Ÿ

è¯·åç«¯åŒäº‹ç¡®è®¤åå®ç°æ¥å£ã€‚
